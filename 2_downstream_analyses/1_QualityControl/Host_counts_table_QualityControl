#
###### Get Salmon Gene counts on R ######
#
#use package tximportData to make counts table with all samples 
BiocManager::install("tximportData") 
library(tximportData)

#identify the directory where the Salmon output data are locate
dir = ("/Users/andreaunzueta/Dropbox/NSF_PRFB_GirguisLab/Bioinformatics/Metatranscriptomics_analysis/OysterTranscripts/Salmon_counts/Salmon_output2")
list.files(dir)
#define samples
samples <- read.table(file.path(dir, "samples.txt"), header = TRUE)
samples$sample
#path to each quantification file
files = file.path(dir, samples$sample, "quant.sf")
names(files) = c("e_6h_62A","e_12h_64A","c_9hr_43","neg1",
                 "e_6h_27A","e_12h_29A","c_9hr_48","neg2",
                 "e_6h_32A","e_12h_34A","c_9hr_53","neg3",
                 "e_6h_37","e_12h_39A","c_9hr_58", "neg4",
                 "e_9h_63B","c_6hr_42","c_12hr_44",
                 "e_9h_33B","c_6hr_47","c_12hr_49",
                 "e_9h_28B","c_6hr_52","c_12hr_54A","e_9h_38B",
                 "c_6hr_57","c_12hr_59A")
#30 samples, remove the ones that failed salmon AKA: "mock1","mock2"
metadata$Sample_ID 
all(file.exists(files))
